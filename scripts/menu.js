var ua=navigator.userAgent.toLowerCase();var is_opera=((ua.indexOf("opera")!=-1)||(typeof (window.opera)!="undefined"));var is_saf=((ua.indexOf("applewebkit")!=-1)||(navigator.vendor=="Apple Computer, Inc."));var is_webtv=(ua.indexOf("webtv")!=-1);var is_ie=((ua.indexOf("msie")!=-1)&&(!is_opera)&&(!is_saf)&&(!is_webtv));var is_ie4=((is_ie)&&(ua.indexOf("msie 4.")!=-1));var is_moz=((!is_saf)&&(navigator.product=="Gecko"));var is_kon=(ua.indexOf("konqueror")!=-1);var is_ns=((ua.indexOf("compatible")==-1)&&(ua.indexOf("mozilla")!=-1)&&(!is_opera)&&(!is_webtv)&&(!is_saf));var is_ns4=((parseInt(navigator.appVersion)==4)&&(is_ns));var is_mac=(ua.indexOf("mac")!=-1);var pointer_cursor=(is_ie?"hand":"pointer");function fetch_object(A){if(document.getElementById){return document.getElementById(A)}else{if(document.all){return document.all[A]}else{if(document.layers){return document.layers[A]}else{return null}}}}function fetch_tags(B,A){if(B==null){return new Array()}else{if(typeof B.getElementsByTagName!="undefined"){return B.getElementsByTagName(A)}else{if(B.all&&B.all.tags){return B.all.tags(A)}else{return new Array()}}}}function array_push(A,B){A[A.length]=B;return A.length}function array_pop(A){if(typeof A!="object"||!A.length){return null}else{var B=A[A.length-1];A.length--;return B}}function do_an_e(A){if(!A||is_ie){window.event.returnValue=false;window.event.cancelBubble=true;return window.event}else{A.stopPropagation();A.preventDefault();return A}}function e_by_gum(A){if(!A||is_ie){window.event.cancelBubble=true;return window.event}else{if(A.target.type=="submit"){A.target.form.submit()}A.stopPropagation();return A}}function menu_register(B,A,C){if(typeof menu=="object"){return menu.register(B,A)}}function Popup_Handler(){this.open_steps=10;this.open_fade=false;this.active=false;this.menus=new Array();this.activemenu=null;this.hidden_selects=new Array()}Popup_Handler.prototype.activate=function(A){this.active=A};Popup_Handler.prototype.register=function(B,A){this.menus[B]=new Popup_Menu(B,A);return this.menus[B]};Popup_Handler.prototype.hide=function(){if(this.activemenu!=null){this.menus[this.activemenu].hide()}};var menu=new Popup_Handler();function menu_hide(A){if(A&&A.button&&A.button!=1&&A.type=="click"){return true}else{menu.hide()}}function Popup_Menu(B,A){this.controlkey=B;this.menuname=this.controlkey.split(".")[0]+"_menu";this.init_control(A);if(fetch_object(this.menuname)){this.init_menu()}this.slide_open=(is_opera?false:true);this.open_steps=menu.open_steps}Popup_Menu.prototype.init_control=function(A){this.controlobj=fetch_object(this.controlkey);if (!this.controlobj){return}this.controlobj.state=false;if(this.controlobj.firstChild&&(this.controlobj.firstChild.tagName=="TEXTAREA"||this.controlobj.firstChild.tagName=="INPUT")){}else{if(!A&&!(is_mac&&is_ie)){var C=document.createTextNode(" ");this.controlobj.appendChild(C);var B=document.createElement("img");B.src=dimagedir+"menu_open.gif";B.border=0;B.title="";B.alt="";this.controlobj.appendChild(B)}this.controlobj.unselectable=true;if(!A){this.controlobj.style.cursor=pointer_cursor}this.controlobj.onclick=Popup_Events.prototype.controlobj_onclick;this.controlobj.onmouseover=Popup_Events.prototype.controlobj_onmouseover}};Popup_Menu.prototype.init_menu=function(){this.menuobj=fetch_object(this.menuname);if(this.menuobj&&!this.menuobj.initialized){this.menuobj.initialized=true;this.menuobj.onclick=e_by_gum;this.menuobj.style.position="absolute";this.menuobj.style.zIndex=50;if(is_ie&&!is_mac){this.menuobj.style.filter+="progid:DXImageTransform.Microsoft.alpha(enabled=1,opacity=100)";this.menuobj.style.filter+="progid:DXImageTransform.Microsoft.shadow(direction=135,color=#8E8E8E,strength=3)"}this.init_menu_contents()}};Popup_Menu.prototype.init_menu_contents=function(){var E=fetch_tags(this.menuobj,"td");for(var D=0;D<E.length;D++){if(E[D].className=="menu_option"){if(E[D].title&&E[D].title=="nohilite"){E[D].title=""}else{E[D].controlkey=this.controlkey;E[D].onmouseover=Popup_Events.prototype.menuoption_onmouseover;E[D].onmouseout=Popup_Events.prototype.menuoption_onmouseout;var C=fetch_tags(E[D],"a");if(C.length==1){E[D].className=E[D].className+" menu_option_alink";E[D].islink=true;var B=C[0];var A=false;E[D].target=B.getAttribute("target");if(typeof B.onclick=="function"){E[D].ofunc=B.onclick;E[D].onclick=Popup_Events.prototype.menuoption_onclick_function;A=true}else{if(typeof E[D].onclick=="function"){E[D].ofunc=E[D].onclick;E[D].onclick=Popup_Events.prototype.menuoption_onclick_function;A=true}else{E[D].href=B.href;E[D].onclick=Popup_Events.prototype.menuoption_onclick_link}}if(A){var F=document.createElement("span");F.innerHTML=B.innerHTML;E[D].insertBefore(F,B);E[D].removeChild(B)}}else{if(typeof E[D].onclick=="function"){E[D].ofunc=E[D].onclick;E[D].onclick=Popup_Events.prototype.menuoption_onclick_function}}}}}};Popup_Menu.prototype.show=function(B,A){if(!menu.active){return false}else{if(!this.menuobj){this.init_menu()}}if(!this.menuobj){return false}if(menu.activemenu!=null){menu.menus[menu.activemenu].hide()}menu.activemenu=this.controlkey;this.menuobj.style.display="";if(this.slide_open){this.menuobj.style.clip="rect(auto, 0px, 0px, auto)"}this.pos=this.fetch_offset(B);this.leftpx=this.pos.left;this.toppx=this.pos.top+B.offsetHeight;if((this.leftpx+this.menuobj.offsetWidth)>=document.body.clientWidth&&(this.leftpx+B.offsetWidth-this.menuobj.offsetWidth)>0){this.leftpx=this.leftpx+B.offsetWidth-this.menuobj.offsetWidth;this.direction="right"}else{this.direction="left"}this.menuobj.style.left=this.leftpx+"px";this.menuobj.style.top=this.toppx+"px";if(!A&&this.slide_open){this.intervalX=Math.ceil(this.menuobj.offsetWidth/this.open_steps);this.intervalY=Math.ceil(this.menuobj.offsetHeight/this.open_steps);this.slide((this.direction=="left"?0:this.menuobj.offsetWidth),0,0)}else{if(this.menuobj.style.clip&&this.slide_open){this.menuobj.style.clip="rect(auto, auto, auto, auto)"}}this.handle_overlaps(true);if(this.controlobj.editorid){this.controlobj.state=true;Editor[this.controlobj.editorid].menu_context(this.controlobj,"mousedown")}};Popup_Menu.prototype.hide=function(A){if(A&&A.button&&A.button!=1){return true}this.stop_slide();this.menuobj.style.display="none";this.handle_overlaps(false);if(this.controlobj.editorid){this.controlobj.state=false;Editor[this.controlobj.editorid].menu_context(this.controlobj,"mouseout")}menu.activemenu=null};Popup_Menu.prototype.hover=function(A){if(menu.activemenu!=null){if(menu.menus[menu.activemenu].controlkey!=this.id){this.show(A,true)}}};Popup_Menu.prototype.slide=function(C,B,A){if(this.direction=="left"&&(C<this.menuobj.offsetWidth||B<this.menuobj.offsetHeight)){if(menu.open_fade&&is_ie){A+=10;this.menuobj.filters.item("DXImageTransform.Microsoft.alpha").opacity=A}C+=this.intervalX;B+=this.intervalY;this.menuobj.style.clip="rect(auto, "+C+"px, "+B+"px, auto)";this.slidetimer=setTimeout("menu.menus[menu.activemenu].slide("+C+", "+B+", "+A+");",0)}else{if(this.direction=="right"&&(C>0||B<this.menuobj.offsetHeight)){if(menu.open_fade&&is_ie){A+=10;menuobj.filters.item("DXImageTransform.Microsoft.alpha").opacity=A}C-=this.intervalX;B+=this.intervalY;this.menuobj.style.clip="rect(auto, "+this.menuobj.offsetWidth+"px, "+B+"px, "+C+"px)";this.slidetimer=setTimeout("menu.menus[menu.activemenu].slide("+C+", "+B+", "+A+");",0)}else{this.stop_slide()}}};Popup_Menu.prototype.stop_slide=function(){clearTimeout(this.slidetimer);this.menuobj.style.clip="rect(auto, auto, auto, auto)";if(menu.open_fade&&is_ie){this.menuobj.filters.item("DXImageTransform.Microsoft.alpha").opacity=100}};Popup_Menu.prototype.fetch_offset=function(C){var B=C.offsetLeft;var A=C.offsetTop;while((C=C.offsetParent)!=null){B+=C.offsetLeft;A+=C.offsetTop}return{left:B,top:A}};Popup_Menu.prototype.overlaps=function(C,A){var B=new Array();var D=this.fetch_offset(C);B.L=D.left;B.T=D.top;B.R=B.L+C.offsetWidth;B.B=B.T+C.offsetHeight;if(B.L>A.R||B.R<A.L||B.T>A.B||B.B<A.T){return false}return true};Popup_Menu.prototype.handle_overlaps=function(A){if(is_ie){var D=fetch_tags(document,"select");if(A){var F=new Array();F={L:this.leftpx,R:this.leftpx+this.menuobj.offsetWidth,T:this.toppx,B:this.toppx+this.menuobj.offsetHeight};for(var C=0;C<D.length;C++){if(this.overlaps(D[C],F)){var B=true;var E=D[C];while(E=E.parentNode){if(E.className=="menu_popup"){B=false;break}}if(B){D[C].style.visibility="hidden";array_push(menu.hidden_selects,C)}}}}else{while(true){var C=array_pop(menu.hidden_selects);if(typeof C=="undefined"||C==null){break}else{D[C].style.visibility="visible"}}}}};function Popup_Events(){}Popup_Events.prototype.controlobj_onclick=function(A){if(typeof do_an_e=="function"){do_an_e(A);if(menu.activemenu==null||menu.menus[menu.activemenu].controlkey!=this.id){menu.menus[this.id].show(this)}else{menu.menus[this.id].hide()}}};Popup_Events.prototype.controlobj_onmouseover=function(A){if(typeof do_an_e=="function"){do_an_e(A);menu.menus[this.id].hover(this)}};Popup_Events.prototype.menuoption_onclick_function=function(A){this.ofunc(A);menu.menus[this.controlkey].hide()};Popup_Events.prototype.menuoption_onclick_link=function(A){A=A?A:window.event;if(A.shiftKey||(this.target!=null&&this.target!=""&&this.target.toLowerCase()!="_self")){if(this.target!=null&&this.target.charAt(0)!="_"){window.open(this.href,this.target)}else{window.open(this.href)}}else{window.location=this.href}A.cancelBubble=true;if(A.stopPropagation){A.stopPropagation()}if(A.preventDefault){A.preventDefault()}menu.menus[this.controlkey].hide();return false};Popup_Events.prototype.menuoption_onmouseover=function(A){this.className="menu_hilite"+(this.islink?" menu_hilite_alink":"");this.style.cursor=pointer_cursor};Popup_Events.prototype.menuoption_onmouseout=function(A){this.className="menu_option"+(this.islink?" menu_option_alink":"");this.style.cursor="default"};if(typeof menu=="object"){if(window.attachEvent&&!is_saf){document.attachEvent("onclick",menu_hide);window.attachEvent("onresize",menu_hide)}else{if(document.addEventListener&&!is_saf){document.addEventListener("click",menu_hide,false);window.addEventListener("resize",menu_hide,false)}else{window.onclick=menu_hide;window.onresize=menu_hide}}};