var http_request=false;function ts_ajax_post(A,B){ts_setloading("block");http_request=false;if(window.XMLHttpRequest){http_request=new XMLHttpRequest();if(http_request.overrideMimeType){http_request.overrideMimeType("text/html")}}else{if(window.ActiveXObject){try{http_request=new ActiveXObject("Msxml2.XMLHTTP")}catch(C){try{http_request=new ActiveXObject("Microsoft.XMLHTTP")}catch(C){}}}}if(!http_request){alert(l_ajaxerror2);return false}http_request.onreadystatechange=ts_alertContents;http_request.open("POST",A,true);http_request.setRequestHeader("Content-type","application/x-www-form-urlencoded");http_request.setRequestHeader("Content-length",B.length);http_request.setRequestHeader("Connection","close");http_request.send(B)}function ts_setValue(A,B){window.PreviewValue=A;window.LoadingValue=B}function ts_alertContents(){if(http_request.readyState==4){if(http_request.status==200){result=http_request.responseText;ts_setpreview(result);ts_setloading("none")}else{alert(l_ajaxerror)}}}function ts_get(F,C,B,E,G){ts_setValue(E,G);var A=document.getElementById(F).value;var D=C+"="+encodeURIComponent(A);ts_ajax_post(baseurl+"/"+B,D)}function ts_setloading(A){document.getElementById(LoadingValue).style.display=A}function ts_setpreview(A){document.getElementById(PreviewValue).innerHTML=A};