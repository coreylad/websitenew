<?php
/*
 * @ https://EasyToYou.eu - IonCube v11 Decoder Online
 * @ PHP 7.2 & 7.3
 * @ Decoder version: 1.0.6
 * @ Release: 10/08/2022
 */

$TSSEConfig->TSLoadConfig("SHOUTBOX");
$lang->load("shoutbox");
$lang->load("quick_editor");
require INC_PATH . "/functions_quick_editor.php";
require INC_PATH . "/class_tsquickbbcodeeditor.php";
$QuickEditor = new TSQuickBBCodeEditor();
$QuickEditor->ImagePath = $pic_base_url;
$QuickEditor->SmiliePath = $pic_base_url . "smilies/";
$QuickEditor->FormName = "shoutbox_form";
$QuickEditor->TextAreaName = "shoutbox_message";
$QuickEditor->UpDownButtons = $UpDownButtons;
$QuickEditor->MaxSmilies = $MaxSmilies;
if (!$is_mod) {
    $query = sql_query("SELECT canshout FROM ts_u_perm WHERE $userid = " . sqlesc($CURUSER["id"]));
    if (0 < mysqli_num_rows($query)) {
        $shoutperm = mysqli_fetch_assoc($query);
        if ($shoutperm["canshout"] == "0") {
            $usergroups["canshout"] = "no";
        }
    }
}
$s_pc2perm = isset($s_pc2perm) ? @explode(",", $s_pc2perm) : [];
$s_pc3perm = isset($s_pc3perm) ? @explode(",", $s_pc3perm) : [];
$s_pc4perm = isset($s_pc4perm) ? @explode(",", $s_pc4perm) : [];
$s_pc5perm = isset($s_pc5perm) ? @explode(",", $s_pc5perm) : [];
$SHOUTBOXCONTENTS = "\r\n" . $QuickEditor->GenerateJavascript() . "\r\n\r\n<div $style = \"float: right; margin-top: -39px; margin-right: 30px;\" $id = \"shoutbox\" $name = \"shoutbox\">\r\n\t<select $name = \"channel\" $id = \"channel\" $onchange = \"SwitchChannel(this);\">\r\n\t\t<optgroup $label = \"" . $lang->shoutbox["c"] . "\">\r\n\t\t\t<option $value = \"0\"" . (isset($_COOKIE["TS_LastShoutChannel"]) && $_COOKIE["TS_LastShoutChannel"] == "0" ? " $selected = \"selected\"" : "") . ">" . $lang->shoutbox["c1"] . "</option>\r\n\t\t\t" . (in_array($CURUSER["usergroup"], $s_pc2perm) ? "<option $value = \"1\"" . (isset($_COOKIE["TS_LastShoutChannel"]) && $_COOKIE["TS_LastShoutChannel"] == "1" ? " $selected = \"selected\"" : "") . ">" . $lang->shoutbox["c2"] . "</option>" : "") . "\r\n\t\t\t" . (in_array($CURUSER["usergroup"], $s_pc3perm) ? "<option $value = \"2\"" . (isset($_COOKIE["TS_LastShoutChannel"]) && $_COOKIE["TS_LastShoutChannel"] == "2" ? " $selected = \"selected\"" : "") . ">" . $lang->shoutbox["c3"] . "</option>" : "") . "\r\n\t\t\t" . (in_array($CURUSER["usergroup"], $s_pc4perm) ? "<option $value = \"3\"" . (isset($_COOKIE["TS_LastShoutChannel"]) && $_COOKIE["TS_LastShoutChannel"] == "3" ? " $selected = \"selected\"" : "") . ">" . $lang->shoutbox["c4"] . "</option>" : "") . "\r\n\t\t\t" . (in_array($CURUSER["usergroup"], $s_pc5perm) ? "<option $value = \"4\"" . (isset($_COOKIE["TS_LastShoutChannel"]) && $_COOKIE["TS_LastShoutChannel"] == "4" ? " $selected = \"selected\"" : "") . ">" . $lang->shoutbox["c5"] . "</option>" : "") . "\r\n\t\t</optgroup>\r\n\t</select>\r\n</div>\r\n\r\n<form $method = \"post\" $action = \"" . $_SERVER["SCRIPT_NAME"] . "#shoutbox\" $name = \"shoutbox_form\" $id = \"shoutbox_form\" $onsubmit = \"PostShout(); return false;\">\r\n<table $width = \"100%\" $border = \"0\" $cellpadding = \"4\" $cellspacing = \"0\">\r\n\t<tr>\r\n\t\t<td>\r\n\t\t\t" . ($S_ANNOUNCEMENT ? "\r\n\t\t\t<div $id = \"shout_announcement\" $name = \"shout_announcement\" $style = \"padding-bottom: 2px; width: 100%;\">\r\n\t\t\t\t" . show_notice($S_ANNOUNCEMENT, false, $lang->shoutbox["announcement"], "") . "\r\n\t\t\t</div>\r\n\t\t\t" : "") . "\r\n\t\t\t<div $id = \"unreadpms\"></div>\r\n\t\t\t<div $id = \"shouts\" $name = \"shouts\" $style = \"overflow: auto; height: " . $S_DIVHEIGHT . "px;\"></div>\r\n\t\t</td>\r\n\t</tr>\r\n\t" . ($usergroups["canshout"] != "yes" ? "" : "\r\n\t<tr>\r\n\t\t<td $valign = \"top\">\r\n\t\t\t<table $border = \"0\" $cellpadding = \"1\" $cellspacing = \"0\" $width = \"100%\">\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td class=\"none\">" . $QuickEditor->GenerateBBCode() . "</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td class=\"none\">\t\t\t\t\t\t\r\n\t\t\t\t\t\t<input $style = \"width:" . $S_TEXTAWIDTH . "px; height:" . $S_TEXTAHEIGHT . "px;\" $name = \"shoutbox_message\" $id = \"shoutbox_message\"" . ($usergroups["canshout"] != "yes" ? " $disabled = \"disabled\"" : "") . " /> \r\n\t\t\t\t\t\t<div  class=\"postshout\"><input $type = \"submit\" $name = \"shout_submit\" $value = \"" . $lang->shoutbox["shout"] . "\" $id = \"shout_submit\" class=\"buttonwithpadding\" /><i class=\"fas fa-share fasicon\"></i></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</td>\r\n\t</tr>") . "\r\n\r\n\t" . ($is_mod ? "\r\n\t<tr>\r\n\t\t<td class=\"none\">\r\n\t\t\t<span $id = \"admin_commands\" $name = \"admin_commands\"><i><b>" . $lang->shoutbox["admincommands"] . "</b> <a $href = \"javascript:void(0);\" $onclick = \"ExecCommand('pruneshout'); return false;\" $alt = \"" . $lang->shoutbox["pruneshout1"] . "\" $title = \"" . $lang->shoutbox["pruneshout1"] . "\">" . $lang->shoutbox["pruneshout"] . "</a> | <a $href = \"javascript:void(0);\" $onclick = \"ExecCommand('prune'); return false;\" $alt = \"" . $lang->shoutbox["prune1"] . "\" $title = \"" . $lang->shoutbox["prune1"] . "\">" . $lang->shoutbox["prune"] . "</a> | <a $href = \"javascript:void(0);\" $onclick = \"ExecCommand('ban'); return false;\" $alt = \"" . $lang->shoutbox["ban1"] . "\" $title = \"" . $lang->shoutbox["ban1"] . "\">" . $lang->shoutbox["ban"] . "</a> | <a $href = \"javascript:void(0);\" $onclick = \"ExecCommand('unban'); return false;\" $alt = \"" . $lang->shoutbox["unban1"] . "\" $title = \"" . $lang->shoutbox["unban1"] . "\">" . $lang->shoutbox["unban"] . "</a> | <a $href = \"javascript:void(0);\" $onclick = \"ExecCommand('warn'); return false;\" $alt = \"" . $lang->shoutbox["warn1"] . "\" $title = \"" . $lang->shoutbox["warn1"] . "\">" . $lang->shoutbox["warn"] . "</a> | <a $href = \"javascript:void(0);\" $onclick = \"ExecCommand('unwarn'); return false;\" $alt = \"" . $lang->shoutbox["unwarn1"] . "\" $title = \"" . $lang->shoutbox["unwarn1"] . "\">" . $lang->shoutbox["unwarn"] . "</a></i></span>\r\n\t\t</td>\r\n\t</tr>" : "") . "\r\n</table>\r\n</form>\r\n\r\n<script $type = \"text/javascript\">\r\n\tvar Channel = 0, CanShout = \"" . ($usergroups["canshout"] == "yes" ? "yes" : "no") . "\", $isMod = \"" . ($is_mod ? "yes" : "no") . "\", CheckStatus, LastPosterMessage, AutoRefreshTime = \"" . $S_REFRESHTIME * 1000 . "\", TSShoutLastUpdated, $disabledDueInactivity = false;\r\n\r\n\tif(getCookie(\"TS_LastShoutChannel\"))\r\n\t{\r\n\t\tvar TMPChannel = intval(getCookie(\"TS_LastShoutChannel\"));\r\n\t\tif (TMPChannel)\r\n\t\t{\r\n\t\t\$tChannel = TMPChannel;\r\n\t\t}\r\n\t}\r\n\t\r\n\tshowLoaderInShoutbox();\r\n\r\n\tFirstTimeLoad();\r\n\r\n\tfunction FirstTimeLoad()\r\n\t{\r\n\t\$tTSShoutLastUpdated = time();\r\n\t\tDisableTSShoutbox();\r\n\t\tUpdateShout();\r\n\t\$tCheckStatus = setInterval(\"UpdateShout()\", AutoRefreshTime);\r\n\t}\r\n\r\n\tfunction DisableTSShoutbox()\r\n\t{\r\n\t\tclearInterval(CheckStatus);\r\n\t}\r\n\r\n\tfunction EnableTSShoutbox()\r\n\t{\r\n\t\$tdisabledDueInactivity = false;\r\n\t\tFirstTimeLoad();\r\n\t}\r\n\r\n\tfunction UpdateShout()\r\n\t{\r\n\t\tif (TSShoutLastUpdated + " . $S_INACTIVITY * 60 . " < time())\r\n\t\t{\r\n\t\t\tjQuery(\"#shouts\").html('<div $align = \"center\" $style = \"padding-top: 35px;\"><img $src = \"" . $BASEURL . "/ts_shoutbox/images/warned.gif\" $border = \"0\" class=\"middle\"> <b><i>" . $lang->shoutbox["inactive"] . "</i></b></div>');\r\n\t\t\$tdisabledDueInactivity = true;\r\n\t\t\tDisableTSShoutbox();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif(disabledDueInactivity)\r\n\t\t\t{\r\n\t\t\t\$tdisabledDueInactivity = false;\r\n\t\t\t\tshowLoaderInShoutbox();\r\n\t\t\t}\r\n\r\n\t\t\tvar $pars = \"channel=\"+Channel;\r\n\r\n\t\t\tjQuery(\"#noShoutYet\").remove();\r\n\r\n\t\t\tjQuery.ajax\r\n\t\t\t({\r\n\t\t\t\tdata: pars,\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\turl: baseurl+\"/ts_shoutbox/ts_update_shout.php\",\r\n\t\t\t\tcontentType: \"application/x-www-form-urlencoded; $charset = \"+charset,\r\n\t\t\t\tencoding: charset,\r\n\t\t\t\tcache: false,\r\n\t\t\t\ttimeout: 25000,\r\n\t\t\t\tsuccess: function(result)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(result)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tjQuery(\"#shouts\").html(result);\r\n\t\t\t\t\t\tjQuery(\"a.colorbox\").colorbox({photo: true, fixed: true, maxWidth: \"90%\", maxHeight: \"90%\"});\r\n\r\n\t\t\t\t\t\tjQuery('[$rel = \"shoutRows\"]').hover(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $thisSRow = jQuery(this), $thisSID = parseInt(thisSRow.attr(\"data\")), $thisManageShout = jQuery(\"#manage_shout_\"+thisSID);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(thisManageShout.html() != \"\")\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tthisManageShout.show();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar $thisSRow = jQuery(this), $thisSID = parseInt(thisSRow.attr(\"data\"));\r\n\t\t\t\t\t\t\tjQuery(\"#manage_shout_\"+thisSID).hide();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tjQuery.ajax\r\n\t\t\t({\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\turl: baseurl+\"/ts_shoutbox/ts_check_pms.php\",\r\n\t\t\t\tcontentType: \"application/x-www-form-urlencoded; $charset = \"+charset,\r\n\t\t\t\tencoding: charset,\r\n\t\t\t\tcache: false,\r\n\t\t\t\ttimeout: 25000,\r\n\t\t\t\tsuccess: function(result)\r\n\t\t\t\t{\r\n\t\t\t\t\t\$(\"#unreadpms\").html(result);\r\n\t\t\t\t}\r\n\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showLoaderInShoutbox()\r\n\t{\r\n\t\tjQuery(\"#shouts\").html('<div $align = \"center\" $style = \"padding-top: 35px;\"><img $src = \"" . $BASEURL . "/ts_shoutbox/images/progress.gif\" $border = \"0\" $alt = \"\" $title = \"\" $style = \"verical-align: middle; margin-right: 3px;\" /> <b><i>" . $lang->shoutbox["loading"] . "</i></b></div>');\r\n\t}\r\n\r\n\tfunction TSImBack()\r\n\t{\r\n\t\tshowLoaderInShoutbox();\r\n\t\tEnableTSShoutbox();\r\n\t}\r\n\t\r\n\tfunction setCookie(c_name,value,expiredays)\r\n\t{\r\n\t\tvar $exdate = new Date();\r\n\t\texdate.setDate(exdate.getDate()+expiredays);\r\n\t\tdocument.$cookie = c_name+ \"=\" +escape(value)+\r\n\t\t(($expiredays = =null) ? \"\" : \";$expires = \"+exdate.toGMTString());\r\n\t}\r\n\r\n\tfunction getCookie(c_name)\r\n\t{\r\n\t\tif (document.cookie.length>0)\r\n\t\t{\r\n\t\t\$tc_start = document.cookie.indexOf(c_name + \"=\");\r\n\t\t\tif (c_start!=-1)\r\n\t\t\t{\r\n\t\t\t\$tc_start = c_start + c_name.length+1;\r\n\t\t\t\$tc_end = document.cookie.indexOf(\";\",c_start);\r\n\t\t\t\tif ($c_end = =-1) $c_end = document.cookie.length;\r\n\t\t\t\treturn unescape(document.cookie.substring(c_start,c_end));\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tfunction intval( mixed_var, base )\r\n\t{\r\n\t\tvar tmp;\r\n\t\tif( typeof( mixed_var ) == \"string\" )\r\n\t\t{\r\n\t\t\$ttmp = parseInt(mixed_var*1);\r\n\t\t\tif(isNaN(tmp) || !isFinite(tmp)){\r\n\t\t\t\treturn 0;\r\n\t\t\t} else{\r\n\t\t\t\treturn tmp.toString(base || 10);\r\n\t\t\t}\r\n\t\t} else if( typeof( mixed_var ) == \"number\" && isFinite(mixed_var) ){\r\n\t\t\treturn Math.floor(mixed_var);\r\n\t\t} else{\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction time()\r\n\t{\r\n\t\treturn Math.floor(new Date().getTime()/1000);\r\n\t}\r\n\t\r\n\t" . ($is_mod ? "\r\n\tfunction CancelCommands()\r\n\t{\r\n\t\tjQuery(\"#admin_commands\").html(SaveAdminCommands);\r\n\t}\r\n\r\n\tfunction RunAdminCommand()\r\n\t{\r\n\t\$tUseCommand = jQuery(\"#admin_command\").val();\r\n\t\tvar $pars = \"channel=\"+Channel+\"&$command = \"+UseCommand;\r\n\t\t\r\n\t\tjQuery.ajax\r\n\t\t({\r\n\t\t\tdata: pars,\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: baseurl+\"/ts_shoutbox/ts_exec_command.php\",\r\n\t\t\tcontentType: \"application/x-www-form-urlencoded; $charset = \"+charset,\r\n\t\t\tencoding: charset,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 25000,\r\n\t\t\tsuccess: function(response)\r\n\t\t\t{\r\n\t\t\t\tif (!response)\r\n\t\t\t\t{\r\n\t\t\t\t\talert(\"" . $lang->shoutbox["commanddone"] . "\");\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\talert(response);\r\n\t\t\t\t}\r\n\t\t\t\tCancelCommands();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction ExecCommand(CommandName)\r\n\t{\r\n\t\tif ($isMod = = \"yes\")\r\n\t\t{\r\n\t\t\$tSaveAdminCommands = jQuery(\"#admin_commands\").html();\r\n\t\t\tjQuery(\"#admin_commands\").html('<input $type = \"text\" $name = \"admin_command\" $id = \"admin_command\" $value = \"/'+CommandName+' \" $size = \"30\"> <input $type = \"button\" $value = \"" . $lang->shoutbox["runcommand"] . "\" $onclick = \"RunAdminCommand(); return false;\"> <input $type = \"button\" $value = \"" . $lang->shoutbox["cancel"] . "\" $onclick = \"CancelCommands();\">');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\talert(\"" . $lang->global["nopermission"] . "\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}" : "") . "\r\n\t\r\n\t" . ($is_mod || $S_CANEDIT == "yes" ? "\r\n\tfunction CancelEdit(ReplaceText, ShoutID)\r\n\t{\r\n\t\tEnableTSShoutbox();\r\n\t\tjQuery(\"#shout_\"+ShoutID).html(ReplaceText);\r\n\t}\r\n\r\n\tfunction LetsSaveShout(ShoutID)\r\n\t{\r\n\t\$tNewShoutValue = jQuery(\"#newshout_\"+ShoutID).val();\r\n\t\t\r\n\t\tif (NewShoutValue.length > 255)\r\n\t\t{\r\n\t\t\talert(\"" . sprintf($lang->shoutbox["maxchars"], 255) . "\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!NewShoutValue)\r\n\t\t{\r\n\t\t\talert(\"" . $lang->global["dontleavefieldsblank"] . "\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\telse if (CanShout != \"yes\")\r\n\t\t{\r\n\t\t\talert(\"" . $lang->global["nopermission"] . "\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar $pars = \"uid=" . intval($CURUSER["id"]) . "&$channel = \"+Channel+\"&$sid = \"+ShoutID+\"&$newshout = \"+urlencode(NewShoutValue);\r\n\r\n\t\tjQuery.ajax\r\n\t\t({\r\n\t\t\tdata: pars,\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: baseurl+\"/ts_shoutbox/ts_save_shout.php\",\r\n\t\t\tcontentType: \"application/x-www-form-urlencoded; $charset = \"+charset,\r\n\t\t\tencoding: charset,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 25000,\r\n\t\t\tsuccess: function(response)\r\n\t\t\t{\r\n\t\t\t\tif (response)\r\n\t\t\t\t{\r\n\t\t\t\t\tjQuery(\"#shout_\"+ShoutID).fadeOut(\"slow\", function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tjQuery(this).html(response).fadeIn();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tEnableTSShoutbox();\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction EditShout(Sid)\r\n\t{\r\n\t\tvar $pars = \"channel=\"+Channel+\"&$sid = \"+Sid, EditedText = \"\";\r\n\r\n\t\tjQuery.ajax\r\n\t\t({\r\n\t\t\tdata: pars,\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: baseurl+\"/ts_shoutbox/ts_get_shout.php\",\r\n\t\t\tcontentType: \"application/x-www-form-urlencoded; $charset = \"+charset,\r\n\t\t\tencoding: charset,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 25000,\r\n\t\t\tsuccess: function(response)\r\n\t\t\t{\r\n\t\t\t\tif (response)\r\n\t\t\t\t{\r\n\t\t\t\t\tDisableTSShoutbox();\r\n\t\t\t\t\$tSaveShout = jQuery(\"#shout_\"+Sid).html();\r\n\t\t\t\t\$tSaveShoutID = Sid;\r\n\t\t\t\t\tjQuery(\"#shout_\"+Sid).html( '<form $onsubmit = \"LetsSaveShout(SaveShoutID); return false;\"><input $type = \"text\" $size = \"40\" $id = \"newshout_'+SaveShoutID+'\" $value = \"'+response+'\"> <input $type = \"button\" $value = \"" . $lang->shoutbox["save"] . "\" $onclick = \"LetsSaveShout(SaveShoutID);\"> <input $type = \"button\" $value = \"" . $lang->shoutbox["cancel"] . "\" $onclick = \"CancelEdit(SaveShout, SaveShoutID);\"></form>');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}" : "") . "\r\n\t\r\n\t" . ($is_mod || $S_CANDELETE == "yes" ? "\r\n\tfunction DeleteShout(ShoutID)\r\n\t{\r\n\t\tif (!confirm(\"" . $lang->shoutbox["sure"] . "\"))\r\n\t\t{\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tDisableTSShoutbox();\r\n\t\t\r\n\t\tvar $pars = \"uid=" . intval($CURUSER["id"]) . "&$channel = \"+Channel+\"&$sid = \"+ShoutID;\r\n\r\n\t\tjQuery.ajax\r\n\t\t({\r\n\t\t\tdata: pars,\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: baseurl+\"/ts_shoutbox/ts_delete_shout.php\",\r\n\t\t\tcontentType: \"application/x-www-form-urlencoded; $charset = \"+charset,\r\n\t\t\tencoding: charset,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 25000,\r\n\t\t\tsuccess: function(response)\r\n\t\t\t{\r\n\t\t\t\tif ($response = = \"DELETED\")\r\n\t\t\t\t{\r\n\t\t\t\t\tjQuery(\"#shout_\"+ShoutID).html('<div $style = \"color: #fff; background: red; border: 1px solid #000; text-align: center;\">" . $lang->shoutbox["deleted"] . "</div>');\r\n\t\t\t\t}\r\n\t\t\t\tEnableTSShoutbox();\r\n\t\t\t}\r\n\t\t});\r\n\t}" : "") . "\r\n\r\n\tfunction SwitchChannel(ChannelID)\r\n\t{\r\n\t\tshowLoaderInShoutbox();\r\n\t\$tChannel = ChannelID.value;\r\n\t\tsetCookie(\"TS_LastShoutChannel\", Channel, 365);\r\n\t\tDisableTSShoutbox();\r\n\t\$tLastPosterMessage = \"\";\r\n\t\tEnableTSShoutbox();\r\n\t}\r\n\r\n\tfunction PrivateShout(Username)\r\n\t{\r\n\t\tif (Username)\r\n\t\t{\r\n\t\t\tjQuery(\"#shoutbox_message\").val(\"/private \"+Username+\" \").focus();\r\n\t\t}\r\n\t}\r\n\r\n\t" . ($usergroups["canshout"] == "yes" ? "\r\n\tfunction PostShout()\r\n\t{\r\n\t\$tMessage = jQuery(\"#shoutbox_message\").val();\r\n\r\n\t\tif (Message.length > 255)\r\n\t\t{\r\n\t\t\talert(\"" . sprintf($lang->shoutbox["maxchars"], 255) . "\");\r\n\t\t\tjQuery(\"#shoutbox_message\").focus();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tif (!Message)\r\n\t\t{\r\n\t\t\talert(\"" . $lang->global["dontleavefieldsblank"] . "\");\r\n\t\t\tjQuery(\"#shoutbox_message\").focus();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\telse if (CanShout != \"yes\")\r\n\t\t{\r\n\t\t\talert(\"" . $lang->global["nopermission"] . "\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\telse if (LastPosterMessage == Message)\r\n\t\t{\r\n\t\t\talert(\"" . $lang->shoutbox["alreadyposted"] . "\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tvar $pars = \"uid=" . intval($CURUSER["id"]) . "&$channel = \"+Channel+\"&$shout = \"+urlencode(Message);\r\n\r\n\t\tDisableTSShoutbox();\r\n\r\n\t\tjQuery.ajax\r\n\t\t({\r\n\t\t\tdata: pars,\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: baseurl+\"/ts_shoutbox/ts_post_shout.php\",\r\n\t\t\tcontentType: \"application/x-www-form-urlencoded; $charset = \"+charset,\r\n\t\t\tencoding: charset,\r\n\t\t\tcache: false,\r\n\t\t\ttimeout: 25000,\r\n\t\t\tsuccess: function(result)\r\n\t\t\t{\r\n\t\t\t\tif ($result = = \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tEnableTSShoutbox();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (Message.substr(0, 8) != \"/private\")\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tjQuery(\"#shoutbox_message\").val(\"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar $tmpText = Message.split(\" \");\r\n\t\t\t\t\t\tjQuery(\"#shoutbox_message\").val(tmpText[0]+\" \"+tmpText[1]+\" \");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\$tLastPosterMessage = Message;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\talert(result);\r\n\t\t\t\t}\r\n\t\t\t\tjQuery(\"#shoutbox_message\").focus();\r\n\t\t\t}\r\n\t\t});\r\n\t}" : "") . "\r\n</script>" . elastic("shoutbox_message");

?>