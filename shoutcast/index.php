<?php
/*
 * @ https://EasyToYou.eu - IonCube v11 Decoder Online
 * @ PHP 7.2 & 7.3
 * @ Decoder version: 1.0.6
 * @ Release: 10/08/2022
 */

$rootpath = "./../";
require $rootpath . "global.php";
$lang->load("shoutcast");
define("TS_SHOUTCAST", true);
define("S_VERSION", "1.6 by xam");
require "./setup.php";
stdhead($scdef . (isset($servertitle) ? ": " . htmlspecialchars_uni($servertitle) : ""));
$days = ["1" => "Mon", "2" => "Tue", "3" => "Wed", "4" => "Thu", "5" => "Fri", "6" => "Sat", "7" => "Sun"];
$todayis = date("D");
$timenow = date("G:i");
$defaulttemplate = ts_template();
$dimagedir = $BASEURL . "/include/templates/" . $defaulttemplate . "/images/";
if (!$scfp) {
    echo "\r\n\t<div style=\"float: right;\">\r\n\t\t<input type=\"button\" value=\"" . $lang->shoutcast["refresh"] . "\" onclick=\"jumpto('" . $_SERVER["SCRIPT_NAME"] . "'); return false;\" />\r\n\t\t<input type=\"button\" value=\"" . $lang->shoutcast["djlist"] . "\" onclick=\"jumpto('" . $BASEURL . "/shoutcast/dj.php?do=list'); return false;\" />\r\n\t\t<input type=\"button\" value=\"" . $lang->shoutcast["bedj"] . "\" onclick=\"jumpto('" . $BASEURL . "/shoutcast/dj.php?do=request'); return false;\" />\r\n\t</div>\r\n\t<br /><br />\r\n\t" . show_notice($lang->shoutcast["down"], true, $scdef . " - " . $lang->shoutcast["offline"]);
} else {
    if ($streamstatus === "1") {
        ($Query = sql_query("SELECT uid, activedays, activetime, genre, u.username, g.namestyle FROM ts_shoutcastdj LEFT JOIN users u ON (uid=u.id) LEFT JOIN usergroups g ON (u.usergroup=g.gid) WHERE active = '1' ORDER by activetime")) || sqlerr(__FILE__, 48);
        if (mysqli_num_rows($Query)) {
            $activedjlist = "\r\n\t\t\t<table width=\"100%\" align=\"center\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td class=\"subheader\">" . $lang->shoutcast["djname"] . "</td>\r\n\t\t\t\t\t<td class=\"subheader\">" . $lang->shoutcast["adays"] . "</td>\r\n\t\t\t\t\t<td class=\"subheader\">" . $lang->shoutcast["atime"] . "</td>\r\n\t\t\t\t\t<td class=\"subheader\">" . $lang->shoutcast["genre"] . "</td>\r\n\t\t\t\t</tr>";
            $Found = false;
            $ISDJ = false;
            while ($List = mysqli_fetch_assoc($Query)) {
                if ($List["uid"] == $CURUSER["id"]) {
                    $ISDJ = true;
                }
                if (preg_match("@" . $todayis . "@Ui", $List["activedays"])) {
                    $Found = true;
                    $activedjlist .= "\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td><a href=\"" . ts_seo($List["uid"], $List["username"]) . "\">" . get_user_color($List["username"], $List["namestyle"]) . "</a></td>\r\n\t\t\t\t\t\t<td>" . htmlspecialchars_uni($List["activedays"]) . "</td>\r\n\t\t\t\t\t\t<td>" . htmlspecialchars_uni($List["activetime"]) . "</td>\r\n\t\t\t\t\t\t<td>" . htmlspecialchars_uni($List["genre"]) . "</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t";
                }
            }
            if (!$Found) {
                $activedjlist = $lang->shoutcast["down2"];
            } else {
                $activedjlist .= "\r\n\t\t\t\t</table>";
            }
        } else {
            $activedjlist = $lang->shoutcast["down2"];
        }
        echo "\r\n\t\t<script type=\"text/javascript\" src=\"" . $BASEURL . "/scripts/prototype.js?v=" . O_SCRIPT_VERSION . "\"></script>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\tfunction AutoRefreshLS()\r\n\t\t\t{\r\n\t\t\t\tnew Ajax.Request(\"ajax_refresh.php\",\r\n\t\t\t\t{\r\n\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\tcontentType: \"application/x-www-form-urlencoded\",\r\n\t\t\t\t\tencoding: charset,\r\n\t\t\t\t\tonLoading: function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tElement.show(\"loadingimg\");\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonSuccess: function(transport)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar result = transport.responseText;\r\n\t\t\t\t\t\tif(result.match(/<error>(.*)<\\/error>/))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tmessage=result.match(/<error>(.*)<\\/error>/);\r\n\t\t\t\t\t\t\tif(!message[1])\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tmessage[1]=l_ajaxerror;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\talert(l_updateerror+message[1]);\r\n\t\t\t\t\t\t\tElement.hide(\"loadingimg\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\$(\"latestsongs\").innerHTML = result;\r\n\t\t\t\t\t\t\tElement.hide(\"loadingimg\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonFailure: function ()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\talert(l_ajaxerror);\r\n\t\t\t\t\t\tElement.hide(\"loadingimg\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tsetInterval(\"AutoRefreshLS()\", 35000);\r\n\t\t</script>\r\n\t\t<script type=\"text/javascript\" src=\"flashradioswfobject.js\"></script>\r\n\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\tfunction scastmp()\r\n\t\t\t{\r\n\t\t\t\tscastmpWindow = window.open(\"play.php?type=mp\",\"mp\",\"width=360,height=80\");\r\n\t\t\t}\r\n\t\t\tfunction scastrp()\r\n\t\t\t{\r\n\t\t\t\tscastrpWindow = window.open(\"play.php?type=rp\",\"rp\",\"width=420,height=160\");\r\n\t\t\t}\r\n\t\t\tfunction scastqt()\r\n\t\t\t{\r\n\t\t\t\tscastqtWindow = window.open(\"play.php?type=qt\",\"qt\",\"width=330,height=50\");\r\n\t\t\t}\r\n\t\t</script>\r\n\t\t<div style=\"float: right; padding-bottom: 5px;\">\r\n\t\t\t" . ($ISDJ ? "\r\n\t\t\t<input type=\"button\" value=\"" . $lang->shoutcast["manage"] . "\" onclick=\"jumpto('" . $BASEURL . "/shoutcast/dj.php?do=manage'); return false;\" />" : "") . "\r\n\t\t\t<input type=\"button\" value=\"" . $lang->shoutcast["refresh"] . "\" onclick=\"jumpto('" . $_SERVER["SCRIPT_NAME"] . "'); return false;\" />\r\n\t\t\t<input type=\"button\" value=\"" . $lang->shoutcast["djlist"] . "\" onclick=\"jumpto('" . $BASEURL . "/shoutcast/dj.php?do=list'); return false;\" />\r\n\t\t\t<input type=\"button\" value=\"" . $lang->shoutcast["bedj"] . "\" onclick=\"jumpto('" . $BASEURL . "/shoutcast/dj.php?do=request'); return false;\" />\r\n\t\t</div>\r\n\t\t<table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n\t\t\t<tbody>\r\n\t\t\t\t<tr valign=\"top\">\r\n\r\n\t\t\t\t\t<td valign=\"top\" width=\"200\" class=\"none\">\r\n\r\n\t\t\t\t\t<div style=\"padding-bottom: 10px;\">\r\n\t\t\t\t\t\t\t<table width=\"100%\" align=\"center\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td class=\"thead\">" . $lang->shoutcast["tunein"] . "</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"inlineimg\" <img src=\"" . $BASEURL . "/shoutcast/images/im_winamp.gif\" alt=\"" . $lang->shoutcast["listen1"] . "\" border=\"0\" hspace=\"2\" /><a href=\"" . $listenamp . "\">" . $lang->shoutcast["player1"] . "</a><br />\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"inlineimg\" <img src=\"" . $BASEURL . "/shoutcast/images/im_real.gif\" alt=\"" . $lang->shoutcast["listen2"] . "\" border=\"0\" hspace=\"2\" /><a href=\"javascript:scastrp()\">" . $lang->shoutcast["player2"] . "</a><br />\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"inlineimg\" <img src=\"" . $BASEURL . "/shoutcast/images/im_winmp.gif\" alt=\"" . $lang->shoutcast["listen3"] . "\" border=\"0\" hspace=\"2\" /><a href=\"javascript:scastmp()\">" . $lang->shoutcast["player3"] . "</a><br />\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"inlineimg\" <img src=\"" . $BASEURL . "/shoutcast/images/im_qt.gif\" alt=\"" . $lang->shoutcast["listen4"] . "\" border=\"0\" hspace=\"2\" /><a href=\"javascript:scastqt()\">" . $lang->shoutcast["player4"] . "</a>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div style=\"padding-bottom: 10px;\">\r\n\t\t\t\t\t\t\t<table width=\"100%\" align=\"center\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td class=\"thead\">" . $lang->shoutcast["stream"] . "</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<div >" . sprintf($lang->shoutcast["stream2"], 0 + $peaklisteners, 0 + $currentlisteners, 0 + $maxlisteners, 0 + $bitrate, htmlspecialchars_uni($content), 0 + $streamhits, 0 + $averagemin) . "</div>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div style=\"padding-bottom: 10px;\">\r\n\t\t\t\t\t\t\t<table width=\"100%\" align=\"center\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td class=\"thead\">" . $lang->shoutcast["sdetails"] . "</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<img class=\"inlineimg\" <img src=\"" . $BASEURL . "/shoutcast/images/im_genre.gif\" alt=\"" . $lang->shoutcast["genre"] . "\" /> " . htmlspecialchars_uni($servergenre) . "<br /><img class=\"inlineimg\" <img src=\"" . $BASEURL . "/shoutcast/images/im_icq.gif\" alt=\"" . $lang->shoutcast["icq"] . "\" /> " . htmlspecialchars_uni($icq) . "<br /><img class=\"inlineimg\" <img src=\"" . $BASEURL . "/shoutcast/images/im_aim.gif\" alt=\"" . $lang->shoutcast["aim"] . "\" /> " . htmlspecialchars_uni($aim) . "<br /><img class=\"inlineimg\" <img src=\"" . $BASEURL . "/shoutcast/images/im_mirc.gif\" alt=\"" . $lang->shoutcast["irc"] . "\" /> <a href=\"" . htmlspecialchars_uni($irclink) . "\">" . htmlspecialchars_uni($ircsite) . "</a> : " . htmlspecialchars_uni($irc) . "\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t<td valign=\"top\" class=\"none\" style=\"padding-left: 10px\">\r\n\r\n\t\t\t\t\t\t<div style=\"padding-bottom: 10px;\">\r\n\t\t\t\t\t\t\t<table width=\"100%\" align=\"center\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td class=\"thead\">" . $lang->shoutcast["playing"] . "</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td align=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div  id=\"flashcontent\">\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<script type=\"text/javascript\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar browser=navigator.appName;\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar res = \"\";\r\n\t\t\t\t\t\t\t\t\t\t\t\tbrowser = browser.toLowerCase();\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(browser==\"netscape\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tres = \"opened_by=MOZILLA\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tres = \"opened_by=IE\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar webradio = new SWFObject(\"flashradio.swf?\"+res+\"&xml=flashradioconfig.xml&player_skin=flashradiotemplate.swf\", \"flashradiotemplate\",\"576\", \"148\", \"8\", \"#FFFFFF\", true);\r\n\t\t\t\t\t\t\t\t\t\t\t\twebradio.addParam(\"quality\", \"high\");\r\n\t\t\t\t\t\t\t\t\t\t\t\twebradio.addParam(\"allowScriptAccess\", \"always\");\r\n\t\t\t\t\t\t\t\t\t\t\t\twebradio.write(\"flashcontent\");\r\n\t\t\t\t\t\t\t\t\t\t</script>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div style=\"padding-bottom: 10px;\">\r\n\t\t\t\t\t\t\t<table width=\"100%\" align=\"center\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td class=\"thead\">\r\n\t\t\t\t\t\t\t\t\t\t" . $lang->shoutcast["lastsongs"] . "\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<span style=\"float: right;\">\r\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"" . $dimagedir . "loading.gif\" alt=\"\" title=\"\" border=\"0\" id=\"loadingimg\" class=\"inlineimg\" name=\"loadingimg\" style=\"display: none\" />\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t<div id=\"latestsongs\" name=\"latestsongs\">\r\n\t\t\t\t\t\t\t\t\t\t\t" . file_get_contents("lps.dat") . "\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div style=\"padding-bottom: 10px;\">\r\n\t\t\t\t\t\t\t<table width=\"100%\" align=\"center\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\">\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td class=\"thead\">\r\n\t\t\t\t\t\t\t\t\t\t" . $lang->shoutcast["activedj"] . "\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t<tt>" . $activedjlist . "</tt>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t</td>\r\n\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>\r\n\t\t</table>";
    } else {
        echo "\r\n\t\t<div style=\"float: right;\">\r\n\t\t<input type=\"button\" value=\"" . $lang->shoutcast["refresh"] . "\" onclick=\"jumpto('" . $_SERVER["SCRIPT_NAME"] . "'); return false;\" />\r\n\t\t<input type=\"button\" value=\"" . $lang->shoutcast["djlist"] . "\" onclick=\"jumpto('" . $BASEURL . "/shoutcast/dj.php?do=list'); return false;\" />\r\n\t\t<input type=\"button\" value=\"" . $lang->shoutcast["bedj"] . "\" onclick=\"jumpto('" . $BASEURL . "/shoutcast/dj.php?do=request'); return false;\" />\r\n\t\t</div>\r\n\t\t<br /><br />\r\n\t\t" . show_notice($lang->shoutcast["down2"], true, $scdef . " - " . $lang->shoutcast["offline"]);
    }
}
stdfoot();

?>